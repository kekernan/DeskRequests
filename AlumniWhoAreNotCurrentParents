SELECT *
FROM  DONOR
WHERE  DONOR.CFAE_CAT IN ('ALMB', 'ALMG', 'ALMX')
  AND PIDM NOT IN (SELECT APRXREF_PIDM
      FROM APRXREF
    WHERE APRXREF.APRXREF_XREF_CODE = 'CHL'
   AND APRXREF_XREF_PIDM IN (SELECT PIDM
      FROM DONOR
      WHERE CFAE_CAT IN ('STDT')))
   AND NOT EXISTS (SELECT 1
        FROM ALUMNI.APREXCL
        WHERE APREXCL_PIDM = PIDM
          AND (ALUMNI.APREXCL.APREXCL_EXCL_CODE IN ('INL', 'INR', 'RPD', 'DEC',  'NOC')))
   AND DONOR.DEAD_IND IS NULL
